# tiny_merkle_tree.aleo

Implementation of a tiny Merkle tree with 4 leaves. Functionalities:
- create tree
- obtain merkle proof for leaf index
- verify merkle proof for leaf

Uses `feat/array` branch of `testnet`. Test works on branch commit `b6851a9cd89a6fecf14a488dcb8d0bb55a6e717c`. 

## Build Guide

To compile this Aleo program, run:
```bash
snarkvm build
```

To execute this Aleo program, run:
```bash
snarkvm run hello
```

## Testing

### Test 1

1. Create the Merkle Tree with 4 leaves. Random leaves generated with PARI/GP
`random(8444461749428370424248824938781546531375899335154063827935233455917409239041)`.

```bash
leo run get_merkle_tree "[238301186166219052901200372289459967515481170332211409964804596991365959538field, 3795950278952272509684177709511717492358770264218705926196469999516028451558field, 2474474015486685024436037967580855626831756003615187964317247075945013394941field, 304935012962059308453184396462700367016554334407216989241540744905745307181field]"

# {
#   root: 2779279686779388759178862158025689372465268972531690743989389729512552476642field,
#   hash0: 209180463628474213724623583707188530648847102402934390430441285550257720274field,
#   hash1: 5659995640542252071019348940575077197086912373187164616049312455562191344403field,
#   hash2: 6612803362893156458163136722468879128666698640406824027705689953273878045383field,
#   hash3: 4708322267440382696519425194570753169908348644629423465686478242141246053113field,
#   node_l1_1: 7764836589125038804839673714523625104830246099761486108267411651562445577952field,
#   node_l1_2: 2505628426454373281480680392153792826326723580248098801333360715175644569806field
# }
```

2. Get Merkle Proof for a given index. In this example, index is 1. 

```bash
leo run get_merkle_proof "{
  root: 2779279686779388759178862158025689372465268972531690743989389729512552476642field,
  hash0: 209180463628474213724623583707188530648847102402934390430441285550257720274field,
  hash1: 5659995640542252071019348940575077197086912373187164616049312455562191344403field,
  hash2: 6612803362893156458163136722468879128666698640406824027705689953273878045383field,
  hash3: 4708322267440382696519425194570753169908348644629423465686478242141246053113field,
  node_l1_1: 7764836589125038804839673714523625104830246099761486108267411651562445577952field,
  node_l1_2: 2505628426454373281480680392153792826326723580248098801333360715175644569806field
}" 1u8

# {
#   t0: 209180463628474213724623583707188530648847102402934390430441285550257720274field,
#   t1: 2505628426454373281480680392153792826326723580248098801333360715175644569806field,
#   t2: 2779279686779388759178862158025689372465268972531690743989389729512552476642field
# }
```

3. Verify Merkle proof

The previous answer contains 3 elements: the first 2 are proof elements and the final one is the root. Copy those as input to `verify_merkle_proof``.

```bash
leo run verify_merkle_proof 3795950278952272509684177709511717492358770264218705926196469999516028451558field 1u8 "[209180463628474213724623583707188530648847102402934390430441285550257720274field, 2505628426454373281480680392153792826326723580248098801333360715175644569806field]" 2779279686779388759178862158025689372465268972531690743989389729512552476642field

# true - verification succeeded
```
